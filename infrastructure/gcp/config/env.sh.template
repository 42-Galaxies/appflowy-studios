#!/bin/bash

# AppFlowy Studios GCP Configuration Template
# Copy this file to env.sh and fill in your values
# DO NOT commit env.sh to version control

# ==============================================================================
# PROJECT CONFIGURATION
# ==============================================================================

# Project ID - Must be globally unique across all of GCP
# Format: 6-30 characters, lowercase letters, numbers, and hyphens
# Cannot start or end with a hyphen
PROJECT_ID="galaxies-workspace-42"

# Project Display Name - Human-readable name for the project
PROJECT_NAME="42 Galaxies Workspace"

# ==============================================================================
# ORGANIZATION CONFIGURATION (Optional)
# ==============================================================================

# Organization ID - Required if creating project under an organization
# Find with: gcloud organizations list
ORGANIZATION_ID=""

# Folder ID - Required if creating project under a folder (instead of org)
# Find with: gcloud resource-manager folders list --organization=YOUR_ORG_ID
FOLDER_ID=""

# ==============================================================================
# BILLING CONFIGURATION
# ==============================================================================

# Billing Account ID - Required for enabling paid services
# Find with: gcloud billing accounts list
# Format: XXXXXX-XXXXXX-XXXXXX
BILLING_ACCOUNT_ID=""

# ==============================================================================
# BUDGET & ALERTS CONFIGURATION
# ==============================================================================

# Email address for billing alert notifications
ALERT_EMAIL=""

# Monthly budget amount in USD
# Default: 10 USD per month
BUDGET_AMOUNT="10"

# Budget name for identification
BUDGET_NAME="galaxies-workspace-budget"

# Threshold percentage for initial alert (0-100)
# Alerts will trigger at 50%, 75%, 90%, 100%, and 120% regardless
THRESHOLD_PERCENT="50"

# ==============================================================================
# API CONFIGURATION
# ==============================================================================

# Enable optional APIs beyond the required minimum
# Required APIs are always enabled:
# - compute.googleapis.com
# - cloudbuild.googleapis.com  
# - secretmanager.googleapis.com
# - artifactregistry.googleapis.com
#
# Optional APIs include:
# - cloudresourcemanager.googleapis.com
# - serviceusage.googleapis.com
# - iam.googleapis.com
# - monitoring.googleapis.com
# - logging.googleapis.com
# - storage.googleapis.com
ENABLE_OPTIONAL_APIS="true"

# ==============================================================================
# MONITORING CONFIGURATION
# ==============================================================================

# Enable Cloud Monitoring alerts in addition to budget alerts
# This creates more sophisticated alerting policies
ENABLE_MONITORING_ALERTS="true"

# ==============================================================================
# SCRIPT BEHAVIOR
# ==============================================================================

# Show verbose output during script execution
VERBOSE="true"

# ==============================================================================
# REGION CONFIGURATION (Future Use)
# ==============================================================================

# Default region for resources
# See: https://cloud.google.com/compute/docs/regions-zones
DEFAULT_REGION="us-central1"

# Default zone for compute resources
DEFAULT_ZONE="us-central1-a"

# ==============================================================================
# NETWORKING CONFIGURATION (Future Use)
# ==============================================================================

# VPC network name
VPC_NETWORK_NAME="galaxies-vpc"

# Subnet CIDR range
SUBNET_CIDR="10.0.0.0/24"

# ==============================================================================
# SECURITY CONFIGURATION (Future Use)
# ==============================================================================

# Enable VPC Service Controls
ENABLE_VPC_SC="false"

# Enable Private Google Access
ENABLE_PRIVATE_GOOGLE_ACCESS="true"

# ==============================================================================
# BACKUP CONFIGURATION (Future Use)
# ==============================================================================

# Enable automated backups
ENABLE_BACKUPS="true"

# Backup retention period in days
BACKUP_RETENTION_DAYS="30"

# ==============================================================================
# VM CONFIGURATION
# ==============================================================================

# VM instance name
VM_NAME="appflowy-workspace"

# VM zone (should match DEFAULT_ZONE)
VM_ZONE="us-central1-a"

# VM region (derived from zone)
VM_REGION="us-central1"

# VM machine type
# e2-micro: 0.25-2 vCPU, 1GB RAM (free tier eligible)
# e2-small: 0.5-2 vCPU, 2GB RAM
# e2-medium: 1-2 vCPU, 4GB RAM (recommended)
VM_MACHINE_TYPE="e2-medium"

# ==============================================================================
# APPFLOWY CONFIGURATION
# ==============================================================================

# PostgreSQL password for AppFlowy database
# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=""

# GoTrue JWT secret for authentication
# Generate with: openssl rand -base64 32
GOTRUE_JWT_SECRET=""

# AppFlowy service ports
APPFLOWY_PORT="8000"
APPFLOWY_WS_PORT="8001"

# Site URL (leave empty to use VM IP)
# Example: https://workspace.42galaxies.studio
SITE_URL=""

# ==============================================================================
# GOOGLE OAUTH CONFIGURATION
# ==============================================================================

# Enable Google OAuth
GOOGLE_OAUTH_ENABLED="false"

# Google OAuth Client ID (from Google Cloud Console)
GOOGLE_CLIENT_ID=""

# Google OAuth Client Secret (from Google Cloud Console)
GOOGLE_CLIENT_SECRET=""

# ==============================================================================
# EMAIL CONFIGURATION (Optional)
# ==============================================================================

# Auto-confirm email addresses (set to false for production)
MAILER_AUTOCONFIRM="true"

# Disable new user signups
DISABLE_SIGNUP="false"

# SMTP Configuration for email notifications
SMTP_ADMIN_EMAIL=""
SMTP_HOST=""
SMTP_PORT="587"
SMTP_USER=""
SMTP_PASS=""
SMTP_SENDER_NAME="AppFlowy Workspace"

# ==============================================================================
# STORAGE CONFIGURATION (Optional)
# ==============================================================================

# S3-compatible storage for file uploads
# Leave empty to use local storage
S3_ACCESS_KEY_ID=""
S3_SECRET_ACCESS_KEY=""
S3_BUCKET="appflowy-data"
S3_REGION="us-central1"
S3_ENDPOINT=""

# ==============================================================================
# SECURITY CONFIGURATION
# ==============================================================================

# SSH source IP ranges (comma-separated)
# Example: "YOUR_IP/32,OFFICE_IP/24"
# Default: "0.0.0.0/0" (open to all - NOT RECOMMENDED)
SSH_SOURCE_RANGES="0.0.0.0/0"

# ==============================================================================
# NOTES
# ==============================================================================

# 1. This file contains sensitive configuration - DO NOT commit to git
# 2. All scripts source this file for configuration
# 3. Scripts are idempotent - safe to run multiple times
# 4. Use 'setup.sh --verify' to check current configuration
# 5. For help, run: ./setup.sh --help
#
# To generate secure passwords:
#   openssl rand -base64 32
#
# To set up Google OAuth:
#   1. Go to Google Cloud Console > APIs & Services > Credentials
#   2. Create OAuth 2.0 Client ID (Web application)
#   3. Add authorized redirect URI: http://YOUR_DOMAIN/auth/callback
#   4. Copy Client ID and Secret to this file